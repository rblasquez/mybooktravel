"use strict";function _defineProperty(e,a,i){return a in e?Object.defineProperty(e,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[a]=i,e}function calcular(){var e=$("#precio").val();console.log(e);var a=7;e=e.replace("$",""),e=e.replace(",",""),e=$.trim(e),"mybooktravel"==$("input[name=anfitrion]:checked").val()&&(a+=5);var i=e,n=a*parseInt(e)/100,t=parseInt(e)+n;n=$.number(n,0,".",","),t=$.number(t,0,".",","),i=$.number(i,0,".",","),$(".base").html(i),$(".comision").html(n),$(".ingreso").html(t)}function dist_habitaciones(){if(nro_habitaciones>habitaciones){for(var e=nro_habitaciones-habitaciones,a=1;a<=e;a++)nroHabitacion+=1,$(".agregar-habitacion").click();habitaciones=nro_habitaciones}else if(nro_habitaciones<habitaciones){for(var e=habitaciones-nro_habitaciones,a=1;a<=e;a++)nroHabitacion-=1,$(".eliminar-habitacion").last().click();habitaciones=nro_habitaciones}}function bloquearEnvioImagen(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";block(".imagenes-preview",e),block("[role=menu][aria-label=Pagination]")}function desbloquearEnvioImagen(){$(".imagenes-preview").unblock(),$("[role=menu][aria-label=Pagination]").unblock()}function eliminar_imagen(e){bloquearEnvioImagen(),console.log(e);var a=($("input[name=_token]").val(),document.getElementById("rutaBorrarTemporal").href);a=a.replace(":ARCHIVO",e),$.getJSON(a,function(a,i){a.estatus,$(".preview_image[id="+e+"]").parents(".preview_image_container").remove(),desbloquearEnvioImagen(),verificarCantidadImagenes()})}function inicializarRotators(){$(".rotator").unbind("click").on("click",function(e){bloquearEnvioImagen();var a,i=$(this).parents(".preview_image_container"),n=$(i).find(".preview_image"),t=$(n).attr("id");n.on("load",function(e){$(".imagenes-preview").unblock()}),a=$(this).hasClass("clockwise")?"derecha":"izquierda";var o=document.getElementById("rutaRotarTemporal").href;o=o.replace(":ARCHIVO",t),o=o.replace(":SENTIDO",a);var r=$("input[name=_token]").val();$.ajax({url:o,dataType:"json",headers:{"X-CSRF-TOKEN":r}}).done(function(e){$(n).attr("id",e.imagen.id),$(n).attr("src",e.imagen.url),desbloquearEnvioImagen()}).fail(function(e,a,i){console.log(e),console.log(a),console.log(i),desbloquearEnvioImagen()})})}function inicializarSelectorImagenPrimaria(){$(".make_main_image").unbind("click"),$(".make_main_image").on("click",function(){if(""==$(this).attr("for")){var e=Date.now(),a=$(this).parents(".preview_image_header");$(a).find(".main_image_input").attr("id",e),$(this).attr("for",e)}$(this).parents(".preview_image_container").find(".preview_image").attr("id"),$(".asignarImagenPrimaria").attr("href"),$("input[name=_token]").val()})}function verificarCantidadImagenes(){var e=$(".preview_image_container").length;$("#imagenes_guardadas").val(e);var a=$("#cantidad_maxima_imagenes").val();console.log(a),e>=a?$(".add_button").hide():$(".add_button").show()}console.log("prueba2");var contador_imagenes=0,imagenes_cargar=0;jQuery(document).ready(function(e){var a;e("#precio").on("change, keyup",function(e){e.preventDefault(),calcular()}),e(".moneda").inputmask({alias:"numeric",groupSeparator:",",autoGroup:!0,digitsOptional:!0,prefix:"$ ",placeholder:"0"}),e("#moneda_propiedad").on("change",function(a){a.preventDefault(),console.log(e(this).val()),e(".totalizando .moneda_iso").html(e(this).val())}),e("input:text, textarea").maxlength({customMaxAttribute:"90",warningClass:"label label-success",limitReachedClass:"label label-danger",preText:"Tienes ",separator:" de ",postText:" caracteres restantes."}),e(".lugares_cercanos").repeater(_defineProperty({initEmpty:!1,isFirstItemUndeletable:!0,defaultValues:{"text-input":"foo"},show:function(){e(this).slideDown()},hide:function(a){e(this).slideUp(a)},ready:function(e){}},"isFirstItemUndeletable",!0)),e(".dist-habitaciones").repeater((a={initEmpty:!0,isFirstItemUndeletable:!0,defaultValues:{tipo_habitacion:2,tipo_cama:2}},_defineProperty(a,"defaultValues",{tipo_cama:["1"]}),_defineProperty(a,"show",function(){var a=[this];e(this).find("label[for]").each(function(i,n){var t=a[0],o=e(n).attr("for"),r=e(t).find("input[id='"+o+"']");if(e(r).length>0){var l=e(r).attr("name");e(r).attr("id",l),e(t).find("label[for='"+o+"']").attr("for",l)}},a),e(this).slideDown(),e(this).find(".numero-habitacion").html(nroHabitacion)}),_defineProperty(a,"hide",function(a){e(this).slideUp(a)}),_defineProperty(a,"repeaters",[{isFirstItemUndeletable:!0,selector:".inner-repeater",show:function(){e(this).slideDown()},hide:function(a){e(this).slideUp(a)}}]),a)),e("#direccion").on("keydown",function(e){13==e.which&&event.preventDefault()}),e("input[name=anfitrion]").on("change",function(a){var i=e("#anfitriones");i.find(".collapse").collapse("hide"),i.find(".form-control").attr("disabled",!0),"otro"==e(this).val()?(i.find("div#anfitrionDatos").collapse("show"),i.find("input").attr("disabled",!1)):"mybooktravel"==e(this).val()?i.find("div#costo_adicional_anfitrion").collapse("show"):i.collapse("hide"),calcular()}),e("input:radio[name=medio]").on("change",function(a){if("wu"==e(this).val()){var i=e(".wu");i.collapse("show"),e(".transferencia").collapse("hide"),i.find("input").attr("disabled",!1),e(".transferencia").find("input").attr("disabled",!0)}else if("transferencia"==e(this).val()){var i=e(".transferencia");i.collapse("show"),e(".wu").collapse("hide"),i.find("input").attr("disabled",!1),e(".wu").find("input").attr("disabled",!0)}else e(".wu").collapse("hide"),e(".transferencia").collapse("hide"),e(".wu, .transferencia").find("input").attr("disabled",!0)}),e("input:radio[name=oferta_propiedad_id]").on("change",function(a){a.preventDefault(),e(".ayudaOferta").collapse("hide"),e("#ayudaOferta"+e(this).val()).collapse("show")}),e("input:radio[name=garantia_reserva_id]").on("change",function(a){a.preventDefault(),e(".ayudaGarantia").collapse("hide"),e("#ayudaGarantia"+e(this).val()).collapse("show")}),e(".check-tarifa").on("change",function(a){a.preventDefault();var i=e(this);if(i.prop("checked"))var n="show",t=!1;else var n="hide",t=!0;i=i.parents("div.tarifa"),i.find(".costo").collapse(n),i.find("input:text").attr("disabled",t)})});var mostrarMapa=!1;$("#formPublicar").steps({titleTemplate:"#title#",headerTag:"h3",bodyTag:"div",transitionEffect:"slideLeft",autoFocus:!0,labels:{cancel:"Cancelars",finish:"Publicar",next:"Siguiente",previous:"Anterior",loading:"Cargando ..."},onInit:function(e,a){$(".wizard > .actions > ul > li:nth-child(1) a").css({display:"none"}),$(".wizard > .actions > ul > li").addClass("pull-right")},onContentLoaded:function(e,a){console.log("Prueba")},onStepChanged:function(e,a,i){if(1==a){dist_habitaciones();var n=0;$(".banio").click(function(e){var a=$(this).siblings("input[type=checkbox]")[0].checked;n==nro_banios&&0==a&&e.preventDefault()}),$(".tiene_banio").on("change",function(e){n=$(".tiene_banio:checked").length})}2==a&&0==mostrarMapa&&(mapaPropiedadCrear(),mostrarMapa=!0)},onStepChanging:function(e,a,i){var n=$(this).parent("form");return 0==i?($(".wizard > .actions > ul > li:nth-child(1) a").css({display:"none"}),$(".wizard > .actions > ul > li").addClass("pull-right")):($(".wizard > .actions > ul > li:nth-child(1) a").css({display:"block"}),$(".wizard > .actions > ul > li").removeClass("pull-right")),!(a<i)||n.valid()},onFinishing:function(e,a){0==$("input[name=anfitrion]:checked").length?swal({icon:"info",title:"Espera!",text:"no indicaste un anfitrión para tu propiedad!"}).then(function(e){$("html, body").animate({scrollTop:$("#anfitriones").offset().top-140+"px"},"fast")}):0==$("input[name=medio]:checked").length?swal({icon:"info",title:"Espera!",text:"no seleccionaste un medio de pago!"}).then(function(e){$("html, body").animate({scrollTop:$("#metodoPagoSeccion").offset().top-140+"px"},"fast")}):$(this).parent("form").submit()}}),$("#frmStore").on("submit",function(e){e.preventDefault(),0==Object.keys(validate.invalid).length&&(block("#frmStore"),$.ajax({url:$(this).attr("action"),type:$(this).attr("method"),dataType:"json",data:$(this).serialize()}).done(function(e){var a=$("#rutaPropiedad").attr("href").replace(":ID",e.id);swal({icon:"success",title:"Completado!",text:"Su propiedad ha sido publicada correctamente, puede editarla para agregar mas fotos y el detalle de las habitaciones",buttons:!1,timer:3e3}).then(function(e){$("#frmStore").unblock(),location.href=a}),$("#frmStore").unblock()}).fail(function(e){swal({icon:"error",title:"Disculpa!",text:'Algo ha salido mal, por favor intenta nuevamente, o presiona <strong>"F5"</strong> para recargar el sitio.',animation:!1,html:!0}),$("#frmStore").unblock()}))}),$("input:checkbox[name=tipo_checkin]").on("change",function(e){var a=$("#checkin_estricto");$(this).prop("checked")?a.removeAttr("disabled"):a.attr("disabled",!0)}),""!=$("#nhabitaciones").val()&&$("#nhabitaciones").change();var nro_habitaciones=0;$("#nhabitaciones").on("change",function(e){nro_habitaciones=parseInt($(this).val())});var nro_banios=0;$("#nbanios").on("change keyup keydown",function(e){nro_banios=parseInt($(this).val())});var habitacion=$(".habitacion"),habitaciones=0,nroHabitacion=0;document.addEventListener("DOMContentLoaded",function(e){Imagine.previewer.start({containerSelector:"#contenedor_imagenes_galeria",maxFiles:20,maxFilesOnSelect:20,onSelect:function(e){console.log("seleccionaron archivos"),bloquearEnvioImagen("Archivos Seleccionados")},onFinishSelect:function(e){$(".blockMsg").html("Seleccionó todas, Preparando envío."),inicializarRotators(),verificarCantidadImagenes(),inicializarSelectorImagenPrimaria(),Imagine.compressor.start({containerSelector:"#contenedor_imagenes_galeria",compressionLevel:.6,maxWidth:1920,maxHeight:1080,onFinishEveryImage:function(e){$(".preview_image_container .preview_image").each(function(e,a){console.log(e),console.log(a)})},onfinishAllImages:function(e){Imagine.sender.send({containerSelector:"#contenedor_imagenes_galeria",url:ruta_imagen_temporales,csrfToken:$("[name=_token]").val(),onFinishEveryImage:function(e,a){console.log("imgen enviada"),console.log(a),1==JSON.parse(e.responseText).success?$(a).attr("id",JSON.parse(e.responseText).id_imagen):($(a).parents(".preview_image_container").remove(),inicializarRotators(),verificarCantidadImagenes(),inicializarSelectorImagenPrimaria(),desbloquearEnvioImagen())},onfinishAllImages:function(){console.log("envió todas"),desbloquearEnvioImagen()}})}})}})}),setInterval(function(){$(".preview_image_container .delete").each(function(e,a){var i=$(a).attr("onclick"),n="eliminar_imagen($(this).parents('.preview_image_container').find('.preview_image').attr('id'))";i!=n&&($(a).attr("onclick",""),$(a).attr("onclick",n))})},100);